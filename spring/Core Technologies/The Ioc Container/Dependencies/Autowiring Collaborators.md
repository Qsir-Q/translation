# 自动注入(Autowiring) 
Spring容器可以自动连接协作bean之间的关系。
您可以让Spring通过检查ApplicationContext的内容来自动为您的bean解析合作者(其他bean)。
自动装配有以下优点：

- 自动装配可以显著减少指定属性或构造函数参数的需要。(其他机制，如本章其他地方讨论的bean模板，在这方面也很有价值。)
- 自动装配可以随着对象的发展而更新配置。例如，如果您需要向类中添加依赖项，则无需修改配置即可自动满足该依赖项。因此，自动装配在开发过程中特别有用，当代码库变得更加稳定时，不排除切换到显式连接的选择
- 当使用基于xml的配置元数据时(参见依赖注入)，您可以使用<bean/>元素的autowire属性为bean定义指定自动注入模式。
  自动装配功能有四种模式。您可以指定每个bean的自动装配，因此可以选择自动装配哪些bean。下表描述了四种自动装配模式
  1. no (默认)没有自动装配。Bean引用必须由ref元素定义。对于大型部署，不建议更改默认设置，因为显式指定协作者可以提供更好的控制和清晰度。在某种程度上，它记录了系统的结构
  2. byName 按属性名自动生成。Spring查找与需要自动注入的属性同名的bean。例如，如果一个bean定义通过名称设置为自动注入，并且它包含一个主属性(也就是说，它有一个setMaster(..)方法)，Spring将查找一个名为master的bean定义，并使用它来设置该属性
  3. byType 如果容器中只存在一个属性类型的bean，则允许自动注入属性。如果存在一个以上的bean，则抛出一个致命异常，这表明您不能对该bean使用byType自动装配。如果没有匹配的bean，什么也不会发生(没有设置属性)。
  4. constructor 类似于byType，但适用于构造函数参数。如果容器中没有一个构造函数参数类型的bean，则会引发致命错误。

使用byType或构造函数自动注入模式，您可以注入数组和类型化集合。在这种情况下，将提供容器中与预期类型匹配的所有自动候选项，以满足依赖项。如果期望的键类型是String，则可以自动连接强类型的Map实例。
自动连接的Map实例的值由与预期类型匹配的所有bean实例组成，Map实例的键包含相应的bean名称。 

>  这个在某些时候很有用，可以拿到接口下的所有实现类



# 自动装配的限制和缺点
自动装配在整个项目中一致使用时效果最好。如果通常不使用自动装配，那么仅使用它来注入一个或两个bean定义可能会使开发人员感到困惑考虑自动装配的限制和缺点：
- 属性和构造函数参数设置中的显式依赖关系总是覆盖自动注入。您不能自动注入简单的属性，如基本数据类型、字符串和类(以及这些简单属性的数组)。这种限制是设计出来的
- 自动注入不如显式声明精确。不过，正如前面的表所指出的，Spring会小心地避免猜测，以免歧义可能产生意想不到的结果。不再显式地记录spring管理的对象之间的关系
- 从Spring容器生成文档的工具可能无法获得连接信息
- 容器中的多个bean定义可以与自动注入的setter方法或构造函数参数指定的类型匹配。对于数组、集合或Map实例，这并不一定是个问题。然而，对于期望单个值的依赖项，这种模糊性不是任意解决的。如果没有唯一的bean定义可用，则抛出异常
  在后一种情况下，您有几个选项:
  1. 放弃自动注入，采用显式声明
  2. 通过将bean的autowire-candidate属性设置为false来避免自动装配bean定义，如下一节所述
  3. 通过将其<bean/>元素的主要属性设置为true，将单个bean定义指定为主要候选对象
  4. 使用基于注解的配置实现更细粒度的控制，如基于注解的容器配置中所述。



# 从自动装配中排除Bean

在每个bean的基础上，您可以从自动装配中排除一个bean。在Spring的XML格式中，将<bean/>元素的autowire-candidate属性设置为false。容器使得该特定bean定义对自动装配基础设施(包括注解样式配置，如@Autowired)不可用。

> autowire-candidate属性被设计为只影响基于类型的自动注入。
> 它不影响按名称的显式引用，即使指定的bean没有被标记为自动注入，也可以解析显式引用。
> 因此，如果名称匹配，按名称自动注入仍然会注入一个bean。

您还可以基于对bean名称的模式匹配来限制自动调用候选者。顶层<beans/>元素在其default-autowire-candidate属性中接受一个或多个模式。例如，为了将候选状态限制为名称以Repository结尾的任何bean，可以提供*Repository的值。要提供多个模式，请在逗号分隔的列表中定义它们。bean定义的autowire-candidate属性的显式值true或false总是优先。对于这样的bean，模式匹配规则不适用

这些技术对于永远不希望通过自动装配将其注入到其他bean中的bean非常有用。这并不意味着不能通过自动装配来配置被排除的bean本身。相反，bean本身并不是自动装配其他bean的候选对象。